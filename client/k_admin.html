<template name="kAdmin">
	<div class="container">
		<div class="row">
			<div class="col-md-8">
				{{#if currentCollection}}
					<h1>{{ panelName }} - Managing {{currentCollection}}</h1>
				{{else}}
					<h1>{{ panelName }}</h1>
				{{/if}}
			</div>
			<div class="col-md-2">
				<br />
				<button type="button" class="btn btn-default btn-lg dropdown-toggle btn-block" data-toggle="dropdown" aria-expanded="false">
				{{ currentlyManaging }} <span class="caret"></span>
				</button>
				<ul class="dropdown-menu" role="menu" id="kAdminSelector">
					{{#each collections}}
						<li><a href="#" data-collection="{{ this }}">{{ this }}</a></li>
					{{/each}}
				</ul>
				<!-- TODO: Reset -->
			</div>
			<div class="col-md-2 text-right">
				{{#if currentCollection}}
					<br />
					<a class="btn btn-success action" data-action="create">Add {{ currentCollection }}</a>
				{{/if}}
			</div>
		</div>

		{{#if loading}}
			{{> spinner}}
		{{/if}}

		{{#if currentCollection}}
			{{#if actionCenter}}
				<div class="row">
					<div class="col-sm-12">
						<div class="panel" id="kAdminActionCenter">
							<div class="panel-body">
								{{#if actionCenterCheck 'create'}}
									<h3>Create</h3>
									{{> quickForm collection=currentCollection id="kAdminForm" type="insert"}}
								{{/if}}
								{{#if actionCenterCheck 'read'}}
									<h3>View</h3>
									<pre>{{ formattedCurrentDoc }}</pre>
								{{/if}}
								{{#if actionCenterCheck 'update'}}
									<h3>Update</h3>
									{{> quickForm collection=currentCollection id="kAdminForm" type="update" doc=currentDoc}}
								{{/if}}
								{{#if actionCenterCheck 'delete'}}
									<h3>Delete</h3>
									{{#quickRemoveButton collection=currentCollection _id=currentDoc._id onSuccess=deleteSuccess onError=deleteError class="btn btn-danger btn-block"}}
										Confirm Deletion
									{{/quickRemoveButton}}
									<br />
								{{/if}}
								<button id="cancelAction" class="btn btn-danger btn-block">Cancel</button>
							</div>
						</div>
					</div>
				</div>
			{{/if}}
			<div class="row">
				<div class="col-sm-12">
					<table class="table">
						<thead>
							<tr>
								{{#each collection.tableColumns}}
									<th>{{ label }}</th>
								{{/each}}
								{{#unless collection.tableColumns}}
									<th>ID</th>
								{{/unless}}
								<th class="text-right">Actions</th>
							</tr>
						</thead>
						<tbody>
							{{#each rows}}
								<tr>
									{{#each getAttrs collection.tableColumns}}
										<td>{{ this }}</td>
									{{/each}}
									{{#unless collection.tableColumns}}
										<td>{{ _id }}</td>
									{{/unless}}
									<td class="text-right">
										<div class="btn-group" role="toolbar" aria-label="Admin actions">
											<button class="btn-group btn-info action" data-action="read">View</button>
											<button class="btn-group btn-warning action" data-action="update">Edit</button>
											<button class="btn-group btn-danger action" data-action="delete">Delete</button>
										</div>
									</td>
								</tr>
							{{/each}}
						</tbody>
					</table>
				</div>
			</div>
			<div class="row">
				<div class="col-md-9">
					<p>Records <b>{{ rowsPageStart }}</b> to <b>{{ rowsPageEnd }}</b> of <b>{{ totalRows }}</b></p>
				</div>
				<div class="col-md-3 text-right">
					<!-- Page number in future release 0.2.0 -->
					<div class="btn-group" role="toolbar" aria-label="Pagination">
						{{#if prev}}
							<button id="prev" class="btn btn-primary">Prev</button>
						{{/if}}
						{{#if next}}
							<button id="next" class="btn btn-primary">Next</button>
						{{/if}}
					</div>
					<br /><br />
				</div>
			</div>
		{{else}}
			<h3>Please select a module from the dropdown on top.</h3>
			<p>If you do not see a dropdown, please create the kAdminConfig in your app's common code.</p>
		{{/if}}
	</div>
</template>